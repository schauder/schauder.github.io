---
layout: default
status: publish
published: true
title: A Heisenbug
author:
  display_name: Jens Schauder
  login: admin
  email: jens@schauderhaft.de
  url: http://blog.schauderhaft.de
author_login: admin
author_email: jens@schauderhaft.de
author_url: http://blog.schauderhaft.de
wordpress_id: 1200
wordpress_url: http://blog.schauderhaft.de/?p=1200
date: '2012-10-14 14:47:31 +0200'
date_gmt: '2012-10-14 12:47:31 +0200'
categories:
- article
- Softwaredevelopment
tags:
- debugging
- bug
- heisenbug
comments:
- id: 8494
  author: jessitron
  author_email: jessitron@gmail.com
  author_url: http://blog.jessitron.com
  date: '2012-10-14 15:26:02 +0200'
  date_gmt: '2012-10-14 13:26:02 +0200'
  content: "Getters that modify object state suck!\r\n\r\nI've seen the same problem
    with toStrings that trigger loading and thereby modify state.\r\n\r\nMethods that
    look like simple property access but change state behind the scenes are evil."
- id: 8495
  author: Jens Schauder
  author_email: jens@schauderhaft.de
  author_url: http://blog.schauderhaft.de
  date: '2012-10-14 15:28:34 +0200'
  date_gmt: '2012-10-14 13:28:34 +0200'
  content: "@jessitron agree, but the evil one here is Hibernate convoluting simple
    accessors into mutators"
- id: 8501
  author: Marcin Stachniuk
  author_email: mstachniuk@gmail.com
  author_url: http://mstachniuk.blogspot.com
  date: '2012-10-14 20:46:38 +0200'
  date_gmt: '2012-10-14 18:46:38 +0200'
  content: "Debugging sucks! \r\nHibernate and Relational Databases too, but this
    is another story. Hibernate solve some Problems and provide new. Remember it!"
- id: 8602
  author: Sven Mohr
  author_email: svmohr@gmail.com
  author_url: ''
  date: '2012-10-28 20:59:19 +0100'
  date_gmt: '2012-10-28 18:59:19 +0100'
  content: I've seen almost the same behavior in code generated by Thrift.  On the
    one hand it produces public member variables and on the other it generates getters
    and setters, which modify state... just brilliant.
---
<p><a href="http://en.wikipedia.org/wiki/Heisenbug">Wikipedia defines a Heisenbug</a> as: </p>
<blockquote><p>A software bug that seems to disappear when one attempts to study it.</blockquote></p>
<p>Sometimes one has these nightmare debugging sessions where you can prove that the bug can't happen. But it still does. But I have rarely seen real Heisenbugs. Here is the story of one.</p>
<p>A Coworker once called me to his machine and showed our application and how it failed with a <tt>NullPointerException</tt>. Then he ran the application in the debugger, stepping through the code and the application just worked.</p>
<p>He could repeat this feat as often as he wanted. The perfect Heisenbug. So what was going on?</p>
<p>Well after a lot of really hard <del datetime="2012-10-14T12:51:24+00:00">swearing</del>thinking we found the following: The bug was caused by accessing the field of a property in a Hibernate entity directly, and not through its getter. So the field was lazy loaded and uninitialized and contained <tt>NULL</tt>, causing the <tt>NPE</tt>. </p>
<p>Why did it disappear in the debugger? There was an inspection showing the value returned by the getter. So on the first stop in the debugger the getter was called, Hibernate magic came to life, the field was populated and everything worked like a charm.</p>
<p>The moral of the story?</p>
<p>Don't know. Software development sucks? Hibernate sucks?</p>
